<% flash.each do |name, msg| %>

	<!-- New code (allow for flash elements to be arrays) -->
  <% if msg.class == Array %>
    <% msg.each do |message| %>
      <%= content_tag :div, message, :id => "flash_#{name}" %>
    <% end %>
  <% else %>

    <!-- old code -->
    <%= content_tag :div, msg, :id => "flash_#{name}" if msg.is_a?(String) %>

  <% end %> <!-- don't forget the extra end -->
  
<% end %>